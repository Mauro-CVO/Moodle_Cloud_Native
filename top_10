SELECT peliculas.pelicula_id as id,
        peliculas.titulo,
        COUNT(*) AS numero_rentas,
        ROW_NUMBER () OVER (
            ORDER BY COUNT(*) DESC
        ) AS ranking
FROM rentas inner join inventarios on rentas.inventario_id = inventarios.inventario_id
            inner join peliculas on inventarios.pelicula_id = peliculas.pelicula_id
GROUP BY peliculas.pelicula_id
ORDER BY numero_rentas desc
LIMIT 10;